---
sidebar: sidebar 
permalink: Deploying.GCP.vds_v5.4_prerequisites.html 
summary: GCP和VDS先決條件 
---
= Google Compute Platform（GCP）和VDS先決條件
:allow-uri-read: 




== GCP與VDS要求與注意事項

本文件說明使用NetApp虛擬桌面服務（VDS）部署遠端桌面服務（RDS）所需的元素。「快速檢查清單」提供所需元件的簡短清單、以及為了確保有效部署所需採取的部署前步驟。本指南的其餘部分將根據所做的組態選擇、提供更詳細的每個元素細節。

image:ReferenceArchitectureGCPRDS.png["寬=75%"]



== 快速檢查清單



=== GCP要求

* GCP租戶
* GCP專案
* 已指派擁有者角色的服務帳戶




=== 部署前資訊

* 判斷使用者總數
* 確定GCP區域和區域
* 判斷作用中目錄類型
* 判斷儲存類型
* 識別工作階段主機VM映像或需求
* 評估現有的GCP和內部部署網路組態




== VDS部署詳細要求



=== 終端使用者連線需求

.下列遠端桌面用戶端支援GCP中的RDS：
* link:https://docs.netapp.com/us-en/virtual-desktop-service/Reference.end_user_access.html#overview["適用於Windows的NetApp VDS用戶端"]
+
** 適用於Windows的NetApp VDS用戶端傳出URL安全性要求
+
*** api.cloudworkspace.com
*** vdsclient.app
*** API.vdsclient.app
*** BI.vdsclient.app


** 增強功能：
+
*** VDS隨需喚醒
*** ThinstPrint用戶端和lice ning
*** 自助服務密碼重設
*** 自動伺服器和閘道位址交涉
*** 完整的桌面與串流應用程式支援
*** 提供自訂品牌
*** 安裝程式交換器可自動部署及設定
*** 內建疑難排解工具




* link:https://login.cloudworkspace.com/["NetApp VDS Web用戶端"]
* link:https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/remote-desktop-clients["Microsoft RD用戶端"]
+
** Windows
** MacOS
** ISO
** Android


* 協力廠商軟體和/或精簡型用戶端
+
** 需求：支援RD閘道組態






==== 儲存層

在VDS部署的RDS中、儲存策略的設計目的是讓AVD工作階段VM不會有持續的使用者/公司資料駐留。使用者設定檔、使用者檔案和資料夾的持續資料、以及公司/應用程式資料、均裝載在獨立資料層上的一或多個資料Volume上。

FSLogix是一種設定檔容器化技術、可在工作階段初始化時、將使用者設定檔容器（VHD或VHDX格式）安裝至工作階段主機、以解決許多使用者設定檔問題（例如資料過度擴張和登入緩慢）。

由於此架構、因此需要資料儲存功能。此功能必須能夠處理每天早上/下午大量使用者同時登入/登出時所需的資料傳輸。即使是中等規模的環境、也可能需要大量的資料傳輸需求。資料儲存層的磁碟效能是主要的終端使用者效能變數之一、因此必須特別注意適當調整此儲存設備的效能大小、而不只是儲存容量。一般而言、儲存層的規模應能支援每位使用者5-15 IOPS。



==== 網路

*必要：*所有現有網路子網路的詳細目錄、包括GCP專案透過VPN所看到的任何子網路。部署必須避免重複的子網路。

VDS設定精靈可讓您定義網路範圍、以便在需要或必須避免範圍的情況下、將其納入與現有網路的計畫整合。

在部署期間決定使用者的IP範圍。根據最佳實務做法、僅支援私有範圍內的IP位址。

.支援的選項包括下列項目、但預設為/20範圍：
* 從192到168、255、168、0到255
* 從172.16.0.0到172.31.255
* 10.0.0.0到10.255.255.255




==== CWMGR1

VDS的某些獨特功能（例如節省成本的工作負載排程和即時擴充功能）需要在組織和專案中有管理人員在場。因此、將名為CWMGR1的管理VM部署為VDS安裝精靈自動化的一部分。除了VDS自動化工作之外、此虛擬機器也會將VDS組態保存在SQL Express資料庫、本機記錄檔和稱為DCConfig的進階組態公用程式中。

.視VDS設定精靈中的選擇而定、此VM可用於裝載其他功能、包括：
* RDS閘道
* HTML 5閘道
* RDS授權伺服器
* 網域控制器




=== 部署精靈中的決策樹狀結構

在初始部署中、我們會回答一系列問題、以自訂新環境的設定。以下是要做出的重大決策概要。



==== GCP區域

決定要裝載VDS虛擬機器的GCP區域或區域。請注意、應根據終端使用者和可用服務的鄰近度來選擇該區域。



==== 資料儲存

決定使用者設定檔、個別檔案和公司共用的資料放置位置。選項包括：

* 適用於 GCP Cloud Volumes Service
* 傳統檔案伺服器




== 現有元件的NetApp VDS部署需求



=== 使用現有Active Directory網域控制器進行NetApp VDS部署

此組態類型可延伸現有的Active Directory網域、以支援RDS執行個體。在這種情況下、VDS會將一組有限的元件部署到網域、以支援RDS元件的自動化資源配置與管理工作。

.此組態需要：
* 現有的Active Directory網域控制器、可由GCP VPC網路上的VM存取、通常是透過VPN或GCP中建立的網域控制器。
* 在RDS主機和資料磁碟區加入網域時、新增VDS元件和VDS管理所需的權限。部署程序需要具有網域權限的網域使用者執行指令碼、以建立所需的元素。
* 請注意、VDS部署預設會為VDS建立的VM建立VPC網路。VPC網路可與現有的VPC網路進行對等連接、或將CWMGR1 VM移至現有的VPC網路、並預先定義所需的子網路。




==== 認證與網域準備工具

系統管理員必須在部署程序的某個階段提供網域管理員認證。您可以在稍後建立、使用及刪除暫用網域管理員認證（部署程序完成後）。此外、需要協助建置先決條件的客戶也可以利用網域準備工具。



=== NetApp VDS部署搭配現有檔案系統

VDS會建立Windows共用區、以便從RDS工作階段主機存取使用者設定檔、個人資料夾和公司資料。VDS預設會部署檔案伺服器、但如果您有現有的檔案儲存元件VDS、則可在VDS部署完成後、將共用指向該元件。

.使用和現有儲存元件的需求：
* 元件必須支援SMB v3
* 元件必須與RDS工作階段主機加入相同的Active Directory網域
* 元件必須能夠公開一個用於VDS組態的UNC路徑、所有三個共用區都可以使用一個路徑、或是分別為每個共用區指定不同的路徑。請注意、VDS會設定這些共用的使用者層級權限、確保已將適當的權限授予VDS Automation Services。




== 附錄A：VDS控制面板URL和IP位址

GCP專案中的VDS元件會與Azure中裝載的VDS全域控制面板元件通訊、包括VDS Web應用程式和VDS API端點。若要進行存取、必須安全地將下列基礎URI位址設定為連接埠443的雙向存取：

link:api.cloudworkspace.com[""]
link:autoprodb.database.windows.net[""]
link:vdctoolsapi.trafficmanager.net[""]
link:cjbootstrap3.cjautomate.net[""]

如果您的存取控制裝置只能依IP位址安全列出清單、則應安全列出下列IP位址清單。請注意、VDS使用具有備援公有IP位址的負載平衡器、因此此清單可能會隨著時間而變更：

13.67.190.243 13.67.215.62 13.89.50.12213.67.227.115 13.67.227.230 13.67.227.227223.99.136.91 40.122.119.157 40.78.132.16640.78.129.17 40.122.52.167.70.147.2 40.899.2013.68.178 13.68.118.118.114.118.618.618.618.618.6120811.811.12.811.12.811.811.611.611.611.611.611.611.811.811.811.0.811.0.811.0.811.12.911.0.811.0.611.0.611.0.811.12.911.0.611.0.613.613.613.811.12.911.0.911.0.611.0.613.613.613.611.0.



=== 最佳效能因素

若要獲得最佳效能、請確定您的網路符合下列需求：

* 從用戶端網路到已部署工作階段主機之GCP區域的往返（RTT）延遲應低於150毫秒。
* 當裝載桌面和應用程式的VM連線至管理服務時、網路流量可能會流向國外/地區邊界。
* 若要最佳化網路效能、建議工作階段主機的VM與管理服務配置在同一個區域。




=== 支援的虛擬機器OS映像

由VDS部署的RDS工作階段HsoTS支援下列x64作業系統映像：

* Windows Server 2019
* Windows Server 2016
* Windows Server 2012 R2

